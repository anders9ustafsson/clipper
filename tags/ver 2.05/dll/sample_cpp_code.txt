#include "clipper_dll.h"

/*///////////////////////////////////////////////////////////////////
//polygons are passed to and from Clipper through arrays of float
//using the following format:
//flt[0] = polygon Count 
//flt[1] = polygon[0].vertex Count
//flt[2] = polygon[0].vertex[0].X;
//flt[3] = polygon[0].vertex[0].Y;
//flt[4] = polygon[0].vertex[1].X;
//flt[5] = polygon[0].vertex[1].Y;
//...
//flt[n] = polygon[1].vertex Count
//flt[n+1] = polygon[1].vertex[0].X;
//flt[n+2] = polygon[1].vertex[0].Y;
//...
//any type of polygon (concave, self-intersecting etc) and any 
//numbers of polygons can be added to the clipping task through
//the ClipperAddPolygon() function. With simple polygons, 'holes'
//are inferred by the position of polygons within other polygons 
//of the same type (ie ptSubject or ptClip).
///////////////////////////////////////////////////////////////////*/

//2 overlapping subject polygons ...
float sub[15] = {2, 3, 20,20, 220,20, 120,120, 3, 40,30, 220,90, 60, 180};
//1 clipping polygon ...
float clip[8] = {1, 3, 70,30, 230,30, 150,200};

DrawPolygons(bmp, sub, 0x100033FF, clLightGray32);
DrawPolygons(bmp, clip, 0x10FFFF00, clLightGray32);

int cnt = 0;
void *c = ClipperCreate();
if (c) {
	ClipperAddPolygon(c, sub, ptSubject);
	ClipperAddPolygon(c, clip, ptClip);
	//clip operations: ctIntersection, ctUnion, ctDifference, ctXor
	if (ClipperExecute(c, ctIntersection, &cnt, pftNonZero, pftNonZero) && cnt > 0){
		float *solution = new float [cnt];
		ClipperSolution(c, solution, cnt);
		DrawPolygons(bmp, solution, 0x4066FF66, 0x8000FF00);
		delete [] solution ;
	}
	ClipperFree(c);
}
